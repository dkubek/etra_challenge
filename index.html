<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dávid Kubek">
<meta name="dcterms.date" content="2023-01-31">

<title>ETRA Challenge Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="etra_challenge_files/libs/clipboard/clipboard.min.js"></script>
<script src="etra_challenge_files/libs/quarto-html/quarto.js"></script>
<script src="etra_challenge_files/libs/quarto-html/popper.min.js"></script>
<script src="etra_challenge_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="etra_challenge_files/libs/quarto-html/anchor.min.js"></script>
<link href="etra_challenge_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="etra_challenge_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="etra_challenge_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="etra_challenge_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="etra_challenge_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#getting-data" id="toc-getting-data" class="nav-link active" data-scroll-target="#getting-data">Getting data</a></li>
  <li><a href="#hypotheses" id="toc-hypotheses" class="nav-link" data-scroll-target="#hypotheses">Hypotheses</a></li>
  <li><a href="#hypothesis-1-saccade-frequency" id="toc-hypothesis-1-saccade-frequency" class="nav-link" data-scroll-target="#hypothesis-1-saccade-frequency">Hypothesis 1: Saccade Frequency</a>
  <ul class="collapse">
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">Load Data</a></li>
  <li><a href="#data-manipulation" id="toc-data-manipulation" class="nav-link" data-scroll-target="#data-manipulation">Data Manipulation</a></li>
  <li><a href="#methodology-and-exploration" id="toc-methodology-and-exploration" class="nav-link" data-scroll-target="#methodology-and-exploration">Methodology and Exploration</a>
  <ul class="collapse">
  <li><a href="#natural-scenes" id="toc-natural-scenes" class="nav-link" data-scroll-target="#natural-scenes">Natural scenes</a></li>
  <li><a href="#blank-scenes" id="toc-blank-scenes" class="nav-link" data-scroll-target="#blank-scenes">Blank scenes</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  </ul></li>
  <li><a href="#hypothesis-2-pupil-dilation" id="toc-hypothesis-2-pupil-dilation" class="nav-link" data-scroll-target="#hypothesis-2-pupil-dilation">Hypothesis 2: Pupil dilation</a>
  <ul class="collapse">
  <li><a href="#load-data-1" id="toc-load-data-1" class="nav-link" data-scroll-target="#load-data-1">Load Data</a></li>
  <li><a href="#data-manipulation-1" id="toc-data-manipulation-1" class="nav-link" data-scroll-target="#data-manipulation-1">Data Manipulation</a></li>
  <li><a href="#exploration" id="toc-exploration" class="nav-link" data-scroll-target="#exploration">Exploration</a></li>
  <li><a href="#results-1" id="toc-results-1" class="nav-link" data-scroll-target="#results-1">Results</a></li>
  <li><a href="#discussion-1" id="toc-discussion-1" class="nav-link" data-scroll-target="#discussion-1">Discussion</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ETRA Challenge Report</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dávid Kubek </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 31, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>In 2019, the <a href="https://etra.acm.org/">ETRA</a> organization announced a challenge for the analysis of a dataset pertaining to human eye-movement. The objective of the challenge was to utilize various tools to uncover intriguing relationships and information within the data, potentially leading to novel insights. Additional details regarding the challenge can be found in the official <a href="https://etra.acm.org/2019/challenge.html">Challenge Track Call for Papers</a> issued by ETRA.</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Imports and setup</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> warnings </span>
<span id="cb1-2"><a href="#cb1-2"></a>warnings.simplefilter(action<span class="op">=</span><span class="st">'ignore'</span>, category<span class="op">=</span><span class="pp">FutureWarning</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># Import libraries</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">import</span> pymc <span class="im">as</span> pm</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="im">import</span> arviz <span class="im">as</span> az</span>
<span id="cb1-13"><a href="#cb1-13"></a></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="im">from</span> etra <span class="im">import</span> read_data</span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co"># Apply the default theme</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>sns.set_theme()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="getting-data" class="level1">
<h1>Getting data</h1>
<p>Download zip file of the <a href="http://smc.neuralcorrelate.com/ETRA2019/ETRA2019Challenge.zip">dataset</a>. Description of the dataset and how the data was collected can be found on <a href="https://etra.acm.org/2019/challenge.html">ETRA dataset description</a>.</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Download data</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">from</span> etra <span class="im">import</span> ETRA</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a>dataset <span class="op">=</span> ETRA()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The directory <code>data</code> contains the following directories/files</p>
<ul>
<li><code>data/</code> : Contains subdirectories containing data of individual participants. Each subdirectory is filled with CSV files, each containing 45 seconds of eye tracker data.</li>
<li><code>images/</code> : Contains the images shown to the participants for each task.</li>
<li><code>DataSummary.csv</code> : Contains mouse clicks of the participants for tasks like Puzzle or Where’s Waldo.</li>
</ul>
</section>
<section id="hypotheses" class="level1">
<h1>Hypotheses</h1>
<p>We will be interested in the following hypotheses:</p>
<ol type="1">
<li><p><strong>Is there a point where a participant becomes tired/bored when viewing a scene? (the frequency of saccades decreases) If so, are some scenes less interesting then others?</strong></p>
<p>There are different types of scenes in the study and some might be more visually stimulating then others. For example, it is not unreasonable to expect that a participant will stay much more engaged in a scene with a lot of detail to study then when looking at a blank scene. Another possibility is that during visual searches (picture puzzles, where is Waldo) a participant may become frustrated and just give up on the task.</p>
<p>The reasoning behind the way we are going to measure this is as follows. When a participant is engaged in a scene, we assume that their gaze is going to dart across the scene rapidly, as they are studying all the details and the number of saccades during a fixed time frame is going to be very high. On the other hand, when subject becomes bored or frustrated, we might expect that they are going to rest their gaze at some point and not move their eyes very much (maybe just waiting for the trial to be over) and so the frequency of saccades would to decrease.</p>
<p>However, the decrease in frequency of saccades might not be exactly indicative of the subjects boredom or frustration. It is not unlikely that the frequency of saccades is high every time a new scene is introduced and naturally decreases as the subject becomes acquainted with the scene.</p>
<p>Whatever the reason might be, if there indeed is such a changing point in the frequency of saccades, it might be interesting to study the time for such change and it’s relationship to participant, scene and task.</p></li>
<li><p><strong>Does the pupil size change depending on scene? What about dependence on task?</strong></p>
<p>The motivation behind this hypothesis is that we would like to study the excitement of a subject viewing some scene or performing some task. One of the indicators of excitement might be the change in pupil size (i.e.&nbsp;we expect pupil to dilate during excitement and contract otherwise).</p>
<p>There are various tasks and scenes and the level of excitement (pupil dilation) might differ in each:</p>
<ul>
<li><p>in <strong>picture puzzles</strong> we might expect that the level of excitement is kept high during the whole duration, peaking when subject finds a difference</p></li>
<li><p>in <em><strong>Where is Waldo?</strong></em> puzzle we might expect the level of excitement being low as the subject is having difficulties finding Waldo and peaking when (if) Waldo is found</p></li>
<li><p>viewing a <strong>blank scene</strong> might not excite much</p></li>
</ul>
<p>Therefore, it is interesting to ask which tasks and scenes are the most stimulating and whether any significant distinction can be made.</p></li>
</ol>
<div class="cell" data-execution_count="4">
<details>
<summary>Choose an example subject</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>subject_no <span class="op">=</span> <span class="dv">22</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="hypothesis-1-saccade-frequency" class="level1">
<h1>Hypothesis 1: Saccade Frequency</h1>
<p>We will restrict ourselves only to the following hypothesis:</p>
<ul>
<li><span class="math inline">\(H_0\)</span> <em>(null hypothesis)</em> : The frequency of saccades does not decrease when viewing a scene.</li>
<li><span class="math inline">\(H_1\)</span> <em>(alternative hypothesis)</em> : The frequency of saccades decreases at some point in the trial.</li>
</ul>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">Load Data</h2>
<p>We will restrict ourselves only to one subject. We have arbitrarily chosen the participant with ID <code>022</code>. We select and load all <em>Free Viewing</em> data with <code>Natural</code> and <code>Blank</code> scenes. We will be interested in columns:</p>
<ul>
<li><code>time</code> : Indicating the time in milliseconds from the beggining of the trail.</li>
<li><code>x</code>, <code>y</code> : The position on the screen where the participant was looking at the given time.</li>
<li><code>rp</code>: Pupil size of the right eye.</li>
</ul>
<p>In <a href="#tbl-hyp1-data">Table&nbsp;1</a> we provide a sample of the data we will use.</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Load data</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>df_hyp1 <span class="op">=</span> (dataset.data_dir <span class="op">/</span> <span class="st">"data"</span> <span class="op">/</span> <span class="st">"</span><span class="sc">{0:0&gt;3}</span><span class="st">"</span>.<span class="bu">format</span>(subject_no)).glob(<span class="st">"*FreeViewing_*.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>df_hyp1 <span class="op">=</span> pd.concat((read_data(f) <span class="cf">for</span> f <span class="kw">in</span> df_hyp1)).sort_values(by<span class="op">=</span><span class="st">"Time"</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a>df_hyp1 <span class="op">=</span> df_hyp1.rename({<span class="st">"Time"</span>: <span class="st">"time"</span>, <span class="st">"trial_id"</span>: <span class="st">"trial"</span>, <span class="st">"LXpix"</span>: <span class="st">"x"</span>, <span class="st">"LYpix"</span>: <span class="st">"y"</span>, <span class="st">"RP"</span>: <span class="st">'rp'</span>}, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a>df_hyp1[<span class="st">"time"</span>] <span class="op">=</span> df_hyp1.groupby([<span class="st">"participant_id"</span>, <span class="st">"trial"</span>])[<span class="st">"time"</span>].transform(<span class="kw">lambda</span> x: x <span class="op">-</span> x.<span class="bu">min</span>())</span>
<span id="cb4-6"><a href="#cb4-6"></a>df_hyp1 <span class="op">=</span> df_hyp1[[<span class="st">'participant_id'</span>, <span class="st">'trial'</span>, <span class="st">'fv_fixation'</span>, <span class="st">'task_type'</span>, <span class="st">'stimulus_id'</span>,</span>
<span id="cb4-7"><a href="#cb4-7"></a>       <span class="st">'time'</span>, <span class="st">'x'</span>, <span class="st">'y'</span>, <span class="st">'rp'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="6">
<details>
<summary>Print sample of hypothesis 1 data</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>df_hyp1.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">
<div id="tbl-hyp1-data" class="anchored">

<div>

<table class="dataframe table table-sm table-striped"><caption>Table&nbsp;1:  Sample of the data for hypothesis 1. </caption>
  <thead>
    <tr>
      <th></th>
      <th>participant_id</th>
      <th>trial</th>
      <th>fv_fixation</th>
      <th>task_type</th>
      <th>stimulus_id</th>
      <th>time</th>
      <th>x</th>
      <th>y</th>
      <th>rp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>022</td>
      <td>001</td>
      <td>FreeViewing</td>
      <td>Puzzle</td>
      <td>puz008</td>
      <td>0</td>
      <td>454.42</td>
      <td>317.175</td>
      <td>585</td>
    </tr>
    <tr>
      <th>1</th>
      <td>022</td>
      <td>001</td>
      <td>FreeViewing</td>
      <td>Puzzle</td>
      <td>puz008</td>
      <td>2</td>
      <td>454.66</td>
      <td>312.000</td>
      <td>585</td>
    </tr>
    <tr>
      <th>2</th>
      <td>022</td>
      <td>001</td>
      <td>FreeViewing</td>
      <td>Puzzle</td>
      <td>puz008</td>
      <td>4</td>
      <td>453.30</td>
      <td>312.375</td>
      <td>585</td>
    </tr>
    <tr>
      <th>3</th>
      <td>022</td>
      <td>001</td>
      <td>FreeViewing</td>
      <td>Puzzle</td>
      <td>puz008</td>
      <td>6</td>
      <td>454.10</td>
      <td>309.450</td>
      <td>587</td>
    </tr>
    <tr>
      <th>4</th>
      <td>022</td>
      <td>001</td>
      <td>FreeViewing</td>
      <td>Puzzle</td>
      <td>puz008</td>
      <td>8</td>
      <td>454.82</td>
      <td>310.725</td>
      <td>585</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="data-manipulation" class="level2">
<h2 class="anchored" data-anchor-id="data-manipulation">Data Manipulation</h2>
<p>First step of the pre-processing will be to remove the blinks. We look at the pupil size and consider every value smaller than some threshold to be an indication of a blink. The average pupil size to be between 1 and 8 mm <span class="citation" data-cites="PupilDiameter">(<a href="#ref-PupilDiameter" role="doc-biblioref"><span>“Pupil Diameter,”</span> n.d.</a>)</span>. We set 1 mm as our threshold. We will then discard a portion of our data around such points. The average blink duration ranges between 100 and 400 ms <span class="citation" data-cites="BlinkDuration">(<a href="#ref-BlinkDuration" role="doc-biblioref"><span>“Average Duration of a Single Eye Blink,”</span> n.d.</a>)</span>. We delete another 200 ms before and after each blink/semi-blink to eliminate the initial and final parts in which the pupil was still partially occluded.</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Function for removing blinks</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">def</span> remove_blinks(data : pd.DataFrame, column<span class="op">=</span><span class="st">'rp'</span>):</span>
<span id="cb6-2"><a href="#cb6-2"></a>    ans <span class="op">=</span> data.copy()</span>
<span id="cb6-3"><a href="#cb6-3"></a>    n_rows <span class="op">=</span> ans.shape[<span class="dv">0</span>]</span>
<span id="cb6-4"><a href="#cb6-4"></a>    </span>
<span id="cb6-5"><a href="#cb6-5"></a>    lows <span class="op">=</span> np.where(ans[<span class="st">'rp'</span>].lt(<span class="dv">100</span>))[<span class="dv">0</span>]</span>
<span id="cb6-6"><a href="#cb6-6"></a>    <span class="cf">for</span> low <span class="kw">in</span> lows:</span>
<span id="cb6-7"><a href="#cb6-7"></a>        ans.loc[<span class="bu">max</span>(<span class="dv">0</span>, low<span class="op">-</span><span class="dv">40</span>):<span class="bu">min</span>(low<span class="op">+</span><span class="dv">40</span>, n_rows), column] <span class="op">=</span> pd.NA</span>
<span id="cb6-8"><a href="#cb6-8"></a>        </span>
<span id="cb6-9"><a href="#cb6-9"></a>    <span class="cf">return</span> ans.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="8">
<details>
<summary>Plot pupil size with and without blinks</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>before <span class="op">=</span> df_hyp1[df_hyp1.trial <span class="op">==</span> <span class="st">'106'</span>].assign(blinks_removed<span class="op">=</span><span class="st">'No'</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>after <span class="op">=</span> remove_blinks(before).assign(blinks_removed<span class="op">=</span><span class="st">'Yes'</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a>hlp <span class="op">=</span> pd.concat([before, after])</span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a>g <span class="op">=</span> sns.relplot(data<span class="op">=</span>hlp, x<span class="op">=</span><span class="st">'time'</span>, y<span class="op">=</span><span class="st">'rp'</span>, kind<span class="op">=</span><span class="st">'line'</span>, row<span class="op">=</span><span class="st">'blinks_removed'</span>, aspect<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb7-6"><a href="#cb7-6"></a>g.set_xlabels(<span class="st">"Time (ms)"</span>)</span>
<span id="cb7-7"><a href="#cb7-7"></a>g.set_ylabels(<span class="st">"Pupil size"</span>)</span>
<span id="cb7-8"><a href="#cb7-8"></a>g.axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">"Pupil size as measured"</span>)</span>
<span id="cb7-9"><a href="#cb7-9"></a>g.axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">"Pupil size with blinks removed"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-blinks-removed" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="etra_challenge_files/figure-html/fig-blinks-removed-output-1.png" width="1424" height="944" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Pupil size data with blinks (top) and with blinks removed (bottom).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>For each trial, we will detect saccades using the <a href="https://github.com/psychoinformatics-de/remodnav">REMoDNaV</a> python library <span class="citation" data-cites="Dar2019">(<a href="#ref-Dar2019" role="doc-biblioref">Dar, Wagner, and Hanke 2019</a>)</span>. This gives us the start and end times of saccades (and other events) as well as additional information such as start and end position of the gaze or peak velocity. We will consider only the start times of the saccades and disregard all other data. <a href="#tbl-natural-sacc-data">Table&nbsp;2</a> lists a sample of the processed data.</p>
<div class="cell" data-execution_count="9">
<details>
<summary>Function for detecting saccades</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="im">from</span> etra <span class="im">import</span> detect</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="kw">def</span> detect_saccades_by_groups(data, groupby<span class="op">=</span>[<span class="st">"participant_id"</span>, <span class="st">"trial"</span>]):</span>
<span id="cb8-4"><a href="#cb8-4"></a>    ans <span class="op">=</span> []</span>
<span id="cb8-5"><a href="#cb8-5"></a>    groups <span class="op">=</span> data.groupby(groupby)</span>
<span id="cb8-6"><a href="#cb8-6"></a>    <span class="cf">for</span> (pid, trial), group <span class="kw">in</span> groups:</span>
<span id="cb8-7"><a href="#cb8-7"></a>        tmp <span class="op">=</span> remove_blinks(group)</span>
<span id="cb8-8"><a href="#cb8-8"></a>        tmp <span class="op">=</span> detect(group)</span>
<span id="cb8-9"><a href="#cb8-9"></a>        tmp <span class="op">=</span> tmp[tmp[<span class="st">"label"</span>] <span class="op">==</span> <span class="st">"SACC"</span>]</span>
<span id="cb8-10"><a href="#cb8-10"></a>        tmp[<span class="st">"participant_id"</span>] <span class="op">=</span> pid</span>
<span id="cb8-11"><a href="#cb8-11"></a>        tmp[<span class="st">"trial"</span>] <span class="op">=</span> trial</span>
<span id="cb8-12"><a href="#cb8-12"></a>        ans.append(tmp)</span>
<span id="cb8-13"><a href="#cb8-13"></a>    </span>
<span id="cb8-14"><a href="#cb8-14"></a>    <span class="cf">return</span> pd.concat(ans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="10">
<details>
<summary>Preprocess data</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>df_hyp1_natural <span class="op">=</span> df_hyp1[df_hyp1.task_type <span class="op">==</span> <span class="st">"Natural"</span>]</span>
<span id="cb9-2"><a href="#cb9-2"></a>df_hyp1_natural_sacc <span class="op">=</span> detect_saccades_by_groups(</span>
<span id="cb9-3"><a href="#cb9-3"></a>    df_hyp1_natural</span>
<span id="cb9-4"><a href="#cb9-4"></a>)</span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a>df_hyp1_blank <span class="op">=</span> df_hyp1[df_hyp1.task_type <span class="op">==</span> <span class="st">"Blank"</span>]</span>
<span id="cb9-7"><a href="#cb9-7"></a>df_hyp1_blank_sacc <span class="op">=</span> detect_saccades_by_groups(</span>
<span id="cb9-8"><a href="#cb9-8"></a>    df_hyp1_blank</span>
<span id="cb9-9"><a href="#cb9-9"></a>)</span>
<span id="cb9-10"><a href="#cb9-10"></a></span>
<span id="cb9-11"><a href="#cb9-11"></a>trial_info_natural <span class="op">=</span> df_hyp1_natural[[<span class="st">'participant_id'</span>, <span class="st">'trial'</span>, <span class="st">'fv_fixation'</span>, <span class="st">'task_type'</span>, <span class="st">'stimulus_id'</span>]].drop_duplicates()</span>
<span id="cb9-12"><a href="#cb9-12"></a>df_hyp1_natural_sacc <span class="op">=</span> trial_info_natural.merge(df_hyp1_natural_sacc, on<span class="op">=</span>[</span>
<span id="cb9-13"><a href="#cb9-13"></a>    <span class="st">"participant_id"</span>, <span class="st">"trial"</span>], how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb9-14"><a href="#cb9-14"></a>df_hyp1_natural_sacc <span class="op">=</span> df_hyp1_natural_sacc[[<span class="st">'participant_id'</span>, <span class="st">'trial'</span>, <span class="st">'fv_fixation'</span>, <span class="st">'task_type'</span>, <span class="st">'stimulus_id'</span>, <span class="st">'start_time'</span>]]</span>
<span id="cb9-15"><a href="#cb9-15"></a></span>
<span id="cb9-16"><a href="#cb9-16"></a>trial_info_blank <span class="op">=</span> df_hyp1_blank[[<span class="st">'participant_id'</span>, <span class="st">'trial'</span>, <span class="st">'fv_fixation'</span>, <span class="st">'task_type'</span>, <span class="st">'stimulus_id'</span>]].drop_duplicates()</span>
<span id="cb9-17"><a href="#cb9-17"></a>df_hyp1_blank_sacc <span class="op">=</span> trial_info_blank.merge(df_hyp1_blank_sacc, on<span class="op">=</span>[</span>
<span id="cb9-18"><a href="#cb9-18"></a>    <span class="st">"participant_id"</span>, <span class="st">"trial"</span>], how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb9-19"><a href="#cb9-19"></a>df_hyp1_blank_sacc <span class="op">=</span> df_hyp1_blank_sacc[[<span class="st">'participant_id'</span>, <span class="st">'trial'</span>, <span class="st">'fv_fixation'</span>, <span class="st">'task_type'</span>, <span class="st">'stimulus_id'</span>, <span class="st">'start_time'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="11">
<details>
<summary>Print sample of processed data</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>df_hyp1_natural_sacc.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<div id="tbl-natural-sacc-data" class="anchored">

<div>

<table class="dataframe table table-sm table-striped"><caption>Table&nbsp;2:  Sample of Freeviewing data. </caption>
  <thead>
    <tr>
      <th></th>
      <th>participant_id</th>
      <th>trial</th>
      <th>fv_fixation</th>
      <th>task_type</th>
      <th>stimulus_id</th>
      <th>start_time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>022</td>
      <td>003</td>
      <td>FreeViewing</td>
      <td>Natural</td>
      <td>nat010</td>
      <td>258</td>
    </tr>
    <tr>
      <th>1</th>
      <td>022</td>
      <td>003</td>
      <td>FreeViewing</td>
      <td>Natural</td>
      <td>nat010</td>
      <td>480</td>
    </tr>
    <tr>
      <th>2</th>
      <td>022</td>
      <td>003</td>
      <td>FreeViewing</td>
      <td>Natural</td>
      <td>nat010</td>
      <td>670</td>
    </tr>
    <tr>
      <th>3</th>
      <td>022</td>
      <td>003</td>
      <td>FreeViewing</td>
      <td>Natural</td>
      <td>nat010</td>
      <td>1166</td>
    </tr>
    <tr>
      <th>4</th>
      <td>022</td>
      <td>003</td>
      <td>FreeViewing</td>
      <td>Natural</td>
      <td>nat010</td>
      <td>1266</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="methodology-and-exploration" class="level2">
<h2 class="anchored" data-anchor-id="methodology-and-exploration">Methodology and Exploration</h2>
<p>To help us understand how we should model the observations, we first look at the distribution of saccades in time. The <span class="math inline">\(x\)</span> axis represents the time from the start of a trial and each row is a sequence of dots representing the start time of a saccade.</p>
<div class="cell" data-execution_count="12">
<details>
<summary>Plot the distriution of saccades in time</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>g <span class="op">=</span> sns.catplot(</span>
<span id="cb11-2"><a href="#cb11-2"></a>    data<span class="op">=</span>df_hyp1_natural_sacc,</span>
<span id="cb11-3"><a href="#cb11-3"></a>    x<span class="op">=</span><span class="st">'start_time'</span>,</span>
<span id="cb11-4"><a href="#cb11-4"></a>    y<span class="op">=</span><span class="st">'stimulus_id'</span>,</span>
<span id="cb11-5"><a href="#cb11-5"></a>    jitter<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb11-6"><a href="#cb11-6"></a>    aspect<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb11-7"><a href="#cb11-7"></a>)</span>
<span id="cb11-8"><a href="#cb11-8"></a>g.set_xlabels(<span class="st">"Start time of a saccade in milliseconds"</span>)</span>
<span id="cb11-9"><a href="#cb11-9"></a>g.set_ylabels(<span class="st">"ID of the stimulus"</span>)</span>
<span id="cb11-10"><a href="#cb11-10"></a>g.<span class="bu">set</span>(title<span class="op">=</span><span class="st">"Distribution of saccades in time"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-saccades-in-time" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="etra_challenge_files/figure-html/fig-saccades-in-time-output-1.png" width="1424" height="483" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Distribution of saccades in time in Natural scenes for one participant.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>As the occurance of a saccade is a complex process that depends on the scene viewed, mental state of the participant, tiredness or maybe even things like personal history, eyesight, mood and many other factors, it is impossible for us to accurately predict the occurance of the next saccade. To simplify the situation, we might look at it as on a stochastic process, where for some small enough time interval, we have a fixed probability for an occurance of a saccade.</p>
<p>Let <span class="math inline">\(N_t\)</span> be a variable counting the number of saccades in a time interval <span class="math inline">\([0,t]\)</span>. Our assumption can be formulated as <span class="math display">\[
\lim_{t \to 0} \Pr[N_t \ge 1]/t = \lambda
\]</span> for some <span class="math inline">\(\lambda \in \mathbb{R}^+\)</span>. That is, the probability of an saccade in a small time interval <span class="math inline">\([0, t]\)</span> tends to <span class="math inline">\(\lambda t\)</span>.</p>
<p>Due to physical human limitations, we also have <span class="math display">\[
\lim_{t \to 0} \Pr[N_t \ge 2]/t = 0
\]</span> or said differently, for a small enough time interval, it is impossible to have two or more successive saccades.</p>
<p>The number of saccades in some interval <span class="math inline">\([t, s]\)</span> can be expressed then as <span class="math inline">\(N(t) - N(s)\)</span>. Additionally, we will assume that for any two disjoint time intervals <span class="math inline">\([t_1, t_2]\)</span> and <span class="math inline">\([t_3, t_4]\)</span>, the distribution of <span class="math inline">\(N(t_2) - N(t_1)\)</span> is independent of the distribution of <span class="math inline">\(N(t_4) - N(t_3)\)</span>.</p>
<p>With these assumtions in place, we are justified to model the occurances of saccades as a <em>Poisson process</em> with rate <span class="math inline">\(\lambda\)</span> <span class="citation" data-cites="mitzenmacher_upfal_2012">(<a href="#ref-mitzenmacher_upfal_2012" role="doc-biblioref">Mitzenmacher and Upfal 2012</a>)</span>.</p>
<div class="cell" data-execution_count="13">
<details>
<summary>Function for counting the number of saccades each second</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">def</span> saccade_frequency_count_by_second(data):</span>
<span id="cb12-2"><a href="#cb12-2"></a>    <span class="co">""" Count the number of saccades in each second of the trial """</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>    </span>
<span id="cb12-4"><a href="#cb12-4"></a>    bins <span class="op">=</span> (data.start_time <span class="op">//</span> <span class="dv">1000</span>).value_counts().sort_index()</span>
<span id="cb12-5"><a href="#cb12-5"></a>    data <span class="op">=</span> pd.DataFrame({<span class="st">"time"</span>: <span class="bu">range</span>(<span class="dv">45</span>)})</span>
<span id="cb12-6"><a href="#cb12-6"></a>    data[<span class="st">"sacc_count"</span>] <span class="op">=</span> bins</span>
<span id="cb12-7"><a href="#cb12-7"></a>    data.fillna(<span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-8"><a href="#cb12-8"></a>    data.sacc_count <span class="op">=</span> data.sacc_count.astype(<span class="bu">int</span>)</span>
<span id="cb12-9"><a href="#cb12-9"></a>    </span>
<span id="cb12-10"><a href="#cb12-10"></a>    <span class="cf">return</span> data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The theory of Poisson processes then tells us that the number of saccades in some time period of length <span class="math inline">\(t\)</span> is a Poisson random variable with expectation <span class="math inline">\(\lambda t\)</span>. We will divide the time of the experiment to seconds (so <span class="math inline">\(t = 1\)</span>) and count the number of saccades in each second. The <a href="#fig-saccade-dist">Figure&nbsp;3</a> illustrates such counts for one chosen trial.</p>
<div class="cell" data-execution_count="14">
<details>
<summary>Chose one scene as an example</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>stimulus <span class="op">=</span> <span class="st">"nat013"</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>scene <span class="op">=</span> df_hyp1_natural_sacc[df_hyp1_natural_sacc.stimulus_id <span class="op">==</span> stimulus]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="15">
<details>
<summary>Plot the frequency of saccades in time</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>hlp <span class="op">=</span> scene.copy()</span>
<span id="cb14-2"><a href="#cb14-2"></a>hlp.start_time <span class="op">=</span> hlp.start_time.<span class="bu">apply</span>(<span class="kw">lambda</span> ms: ms <span class="op">//</span> <span class="dv">1000</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>hlp, x<span class="op">=</span><span class="st">'start_time'</span>, bins<span class="op">=</span><span class="dv">45</span>, stat<span class="op">=</span><span class="st">"count"</span>, aspect<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb14-5"><a href="#cb14-5"></a>g.set_xlabels(<span class="st">"Time (s)"</span>)</span>
<span id="cb14-6"><a href="#cb14-6"></a>g.set_ylabels(<span class="st">"Number of saccades"</span>)</span>
<span id="cb14-7"><a href="#cb14-7"></a>g.<span class="bu">set</span>(title<span class="op">=</span><span class="ss">f"Frequency of saccades"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-saccade-dist" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="etra_challenge_files/figure-html/fig-saccade-dist-output-1.png" width="1424" height="483" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Frequency of saccades in time for one chosen natural scene.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We are looking for a change in behaviour in our participants. To model it we will assume that in some initial time interval the number of saccades will follow some Poisson process with rate <span class="math inline">\(\lambda_1\)</span> up until some time <span class="math inline">\(\tau\)</span> after which <em>something</em> changes and the saccades will follow a different process with rate <span class="math inline">\(\lambda_2\)</span>.</p>
<p>Let <span class="math inline">\(S_t\)</span> denote the count of saccades at time <span class="math inline">\(t\)</span>. We have <span class="math display">\[
    S_t \sim \mathrm{Poisson}(\lambda^{(t)})
\]</span> However, we do not know what the parameter <span class="math inline">\(\lambda^{(t)}\)</span> is. It might be either <span class="math inline">\(\lambda_1\)</span> or <span class="math inline">\(\lambda_2\)</span> depending on where we put the changing point <span class="math inline">\(\tau\)</span>, so <span class="math display">\[
    \lambda^{(t)} = \begin{cases}
        \lambda_1 &amp;&amp; t &lt; \tau \\
        \lambda_2 &amp;&amp; t \ge \tau
    \end{cases}
\]</span></p>
<p>We will try to infer these variables from our data using Bayesian statistics. We will need to choose prior distributions to do that. For <span class="math inline">\(\lambda_1\)</span> and <span class="math inline">\(\lambda_2\)</span> we need to choose from continouous distribution that is able to obtain (potentially) all positive values. Exponential distribution satisfies this requirement, so we set <span class="math display">\[
\begin{align*}
    \lambda_1 \sim \mathrm{Exp}(\alpha)\\
    \lambda_2 \sim \mathrm{Exp}(\alpha)
\end{align*}
\]</span> where <span class="math inline">\(\alpha\)</span> is some hyper-parameter. As we have no prior knowledge about <span class="math inline">\(\tau\)</span>, we simply choose <span class="math display">\[
    \tau \sim \mathrm{Unif}(0, 44)
\]</span></p>
<p>To help with the inference, we set the hyperparameter <span class="math inline">\(\alpha\)</span> such that <span class="math display">\[
    \frac{1}{\alpha}
    = \mathbb{E}[\lambda \mid \alpha]
    \approx \frac{1}{45} \sum_{t = 0}^{44} S_t
\]</span> which is <em>about</em> the value we would expect the <span class="math inline">\(\lambda\)</span>s to be distributed around.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This approach was adapted from the first chapter of <a href="https://github.com/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers">Bayesian Methods for Hackers</a>.</p>
</div>
</div>
<p>For our modelling we will use the <a href="https://www.pymc.io/welcome.html">PyMC</a> <span class="citation" data-cites="Salvatier2016">(<a href="#ref-Salvatier2016" role="doc-biblioref">Salvatier, Wiecki, and Fonnesbeck 2016</a>)</span> implementation of Monte Carlo Markov Chains, using the NUTS sampler with default parameters to generate <span class="math inline">\(5000\)</span> samples from the posterior distribution.</p>
<div class="cell" data-execution_count="16">
<details>
<summary>Define model for the saccade frequency</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">def</span> model_saccades(data):</span>
<span id="cb15-2"><a href="#cb15-2"></a>    <span class="co"># Get the count data for one chosen trial</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>    count_data <span class="op">=</span> saccade_frequency_count_by_second(data)</span>
<span id="cb15-4"><a href="#cb15-4"></a>    count_data <span class="op">=</span> count_data.sacc_count</span>
<span id="cb15-5"><a href="#cb15-5"></a>    n_count_data <span class="op">=</span> count_data.shape[<span class="dv">0</span>]</span>
<span id="cb15-6"><a href="#cb15-6"></a>    </span>
<span id="cb15-7"><a href="#cb15-7"></a>    <span class="cf">with</span> pm.Model() <span class="im">as</span> model:</span>
<span id="cb15-8"><a href="#cb15-8"></a>        alpha <span class="op">=</span> <span class="fl">1.0</span><span class="op">/</span>count_data.mean()</span>
<span id="cb15-9"><a href="#cb15-9"></a></span>
<span id="cb15-10"><a href="#cb15-10"></a>        lambda_1 <span class="op">=</span> pm.Exponential(<span class="st">"lambda_1"</span>, alpha)</span>
<span id="cb15-11"><a href="#cb15-11"></a>        lambda_2 <span class="op">=</span> pm.Exponential(<span class="st">"lambda_2"</span>, alpha)</span>
<span id="cb15-12"><a href="#cb15-12"></a></span>
<span id="cb15-13"><a href="#cb15-13"></a>        tau <span class="op">=</span> pm.DiscreteUniform(<span class="st">"tau"</span>, lower<span class="op">=</span><span class="dv">0</span>, upper<span class="op">=</span>n_count_data <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb15-14"><a href="#cb15-14"></a></span>
<span id="cb15-15"><a href="#cb15-15"></a>        index <span class="op">=</span> np.arange(n_count_data)</span>
<span id="cb15-16"><a href="#cb15-16"></a>        lambda_ <span class="op">=</span> pm.math.switch( tau <span class="op">&gt;=</span> index, lambda_1, lambda_2 )</span>
<span id="cb15-17"><a href="#cb15-17"></a>        </span>
<span id="cb15-18"><a href="#cb15-18"></a>        delta <span class="op">=</span> pm.Deterministic(<span class="st">"delta"</span>, lambda_2 <span class="op">-</span> lambda_1)</span>
<span id="cb15-19"><a href="#cb15-19"></a></span>
<span id="cb15-20"><a href="#cb15-20"></a>        observation <span class="op">=</span> pm.Poisson(<span class="st">"obs"</span>, lambda_, observed<span class="op">=</span>count_data)</span>
<span id="cb15-21"><a href="#cb15-21"></a>        </span>
<span id="cb15-22"><a href="#cb15-22"></a>    <span class="cf">return</span> model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="17">
<details>
<summary>Run the chain</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>model <span class="op">=</span> model_saccades(scene)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="cf">with</span> model:</span>
<span id="cb16-3"><a href="#cb16-3"></a>    trace <span class="op">=</span> pm.sample(<span class="dv">5_000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="#fig-example-chain-posterior">Figure&nbsp;4</a> shows the posterior distributions of the parameters <span class="math inline">\(\tau\)</span>, <span class="math inline">\(\lambda_1\)</span>, <span class="math inline">\(\lambda_2\)</span> and <span class="math inline">\(\Delta = \lambda_2 - \lambda_1\)</span>, while <a href="#tbl-example-chain-summary">Table&nbsp;3</a> provides summary statistics from the chain.</p>
<div class="cell" data-execution_count="18">
<details>
<summary>Plot the posterior of model parameters</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>az.plot_posterior(trace)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-example-chain-posterior" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="etra_challenge_files/figure-html/fig-example-chain-posterior-output-1.png" width="2415" height="486" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4: The posterior distribution of the model parameters.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="19">
<details>
<summary>Print summary statistics of the chain</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>az.summary(trace)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="18">
<div id="tbl-example-chain-summary" class="anchored">

<div>

<table class="dataframe table table-sm table-striped"><caption>Table&nbsp;3:  Summary statistics for the example chain. </caption>
  <thead>
    <tr>
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>tau</th>
      <td>23.412</td>
      <td>14.961</td>
      <td>1.000</td>
      <td>44.000</td>
      <td>0.478</td>
      <td>0.343</td>
      <td>925.0</td>
      <td>1898.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>lambda_1</th>
      <td>2.072</td>
      <td>0.514</td>
      <td>1.230</td>
      <td>3.034</td>
      <td>0.014</td>
      <td>0.010</td>
      <td>2244.0</td>
      <td>1621.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>lambda_2</th>
      <td>1.993</td>
      <td>0.739</td>
      <td>0.493</td>
      <td>3.054</td>
      <td>0.014</td>
      <td>0.010</td>
      <td>3253.0</td>
      <td>1812.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>delta</th>
      <td>-0.079</td>
      <td>0.913</td>
      <td>-1.765</td>
      <td>1.312</td>
      <td>0.019</td>
      <td>0.013</td>
      <td>2414.0</td>
      <td>2124.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
<p>Notice that the posterior distribution of <span class="math inline">\(\Delta\)</span> is centered around 0, leading us to believe there is no change in the the rate of saccades. In case there was a change, we would expect a shift either to the positive or negative side. This notion is further reinforced by looking at the Highest Density Interval (HDI) of the posterior distribution of <span class="math inline">\(\tau\)</span> which basically spans the entire duration of the trial.</p>
<div class="cell" data-execution_count="20">
<details>
<summary>Calculate the probability of null hypothesis</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>p_l2_ge_l1 <span class="op">=</span> np.mean(trace.posterior[<span class="st">"delta"</span>].values <span class="op">&gt;=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We have</p>
<div class="cell" data-execution_count="21">
<div class="cell-output cell-output-stdout">
<pre><code>Pr[H_0] = Pr[lambda_2 &gt;= lambda_1]= 0.47</code></pre>
</div>
</div>
<p>And as the probability is quite high, we do not reject the null hypothesis in this example.</p>
<section id="natural-scenes" class="level3">
<h3 class="anchored" data-anchor-id="natural-scenes">Natural scenes</h3>
<p>We do the same analysis as above for all trials using <em>Natural</em> scenes for subject <code>022</code>.</p>
<div class="cell" data-execution_count="22">
<details>
<summary>Sample the posterior distributions for all natural scenes</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a>stimuli_natural <span class="op">=</span> df_hyp1_natural_sacc.stimulus_id.unique()</span>
<span id="cb21-2"><a href="#cb21-2"></a>stimuli_natural.sort()</span>
<span id="cb21-3"><a href="#cb21-3"></a>chains_natural <span class="op">=</span> []</span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="cf">for</span> stimulus <span class="kw">in</span> stimuli_natural:</span>
<span id="cb21-5"><a href="#cb21-5"></a>    trial <span class="op">=</span> df_hyp1_natural_sacc[df_hyp1_natural_sacc.stimulus_id <span class="op">==</span> stimulus]</span>
<span id="cb21-6"><a href="#cb21-6"></a>    model <span class="op">=</span> model_saccades(trial)</span>
<span id="cb21-7"><a href="#cb21-7"></a>    <span class="cf">with</span> model:</span>
<span id="cb21-8"><a href="#cb21-8"></a>        chain <span class="op">=</span> pm.sample(<span class="dv">5_000</span>)</span>
<span id="cb21-9"><a href="#cb21-9"></a>        chains_natural.append(chain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="23">
<details>
<summary>Combine Natural data from all chains</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>combined_natural <span class="op">=</span> []</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="cf">for</span> stimulus, chain <span class="kw">in</span> <span class="bu">zip</span>(stimuli_natural, chains_natural):</span>
<span id="cb22-3"><a href="#cb22-3"></a>    df <span class="op">=</span> chain.posterior.to_dataframe()</span>
<span id="cb22-4"><a href="#cb22-4"></a>    df[<span class="st">"stimulus"</span>] <span class="op">=</span> stimulus</span>
<span id="cb22-5"><a href="#cb22-5"></a>    combined_natural.append(df)</span>
<span id="cb22-6"><a href="#cb22-6"></a>    </span>
<span id="cb22-7"><a href="#cb22-7"></a>combined_natural <span class="op">=</span> pd.concat(combined_natural)</span>
<span id="cb22-8"><a href="#cb22-8"></a>combined_natural <span class="op">=</span> combined_natural.assign(abs_delta<span class="op">=</span><span class="kw">lambda</span> _: np.<span class="bu">abs</span>(_[<span class="st">'delta'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="#fig-natural-delta-posterior">Figure&nbsp;5</a> shows the posterior density estimate for <span class="math inline">\(\Delta\)</span> for all <em>Natural</em> scene trials.</p>
<div class="cell" data-execution_count="24">
<details>
<summary>Plot Posterior density of <span class="math inline">\(\Delta\)</span> for all natural scenes.</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>statistic <span class="op">=</span> <span class="st">"delta"</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="co"># Truncate values to 99% most plausible</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>low, up <span class="op">=</span> combined_natural.delta.quantile([<span class="fl">0.005</span>, <span class="fl">0.995</span>])</span>
<span id="cb23-4"><a href="#cb23-4"></a>hlp <span class="op">=</span> pd.DataFrame()</span>
<span id="cb23-5"><a href="#cb23-5"></a>hlp[statistic] <span class="op">=</span> combined_natural[statistic].where(combined_natural[statistic].between(low, up))</span>
<span id="cb23-6"><a href="#cb23-6"></a>hlp[<span class="st">"stimulus"</span>] <span class="op">=</span> combined_natural[<span class="st">"stimulus"</span>]</span>
<span id="cb23-7"><a href="#cb23-7"></a>hlp.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-8"><a href="#cb23-8"></a></span>
<span id="cb23-9"><a href="#cb23-9"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>hlp, x<span class="op">=</span>statistic, hue<span class="op">=</span><span class="st">"stimulus"</span>, kind<span class="op">=</span><span class="st">"kde"</span>, aspect<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb23-10"><a href="#cb23-10"></a>g.ax.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'k'</span>, ls<span class="op">=</span><span class="st">'dashed'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb23-11"><a href="#cb23-11"></a>g.set_xlabels(<span class="st">"$\Delta$"</span>)</span>
<span id="cb23-12"><a href="#cb23-12"></a>g.set_ylabels(<span class="st">"Probability"</span>)</span>
<span id="cb23-13"><a href="#cb23-13"></a>g.<span class="bu">set</span>(title<span class="op">=</span><span class="ss">f"Posterior density of $\Delta$"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-natural-delta-posterior" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="etra_challenge_files/figure-html/fig-natural-delta-posterior-output-1.png" width="1052" height="485" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5: Posterior density of <span class="math inline">\(\Delta\)</span> for all natural scenes of one chosen subject.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>There does seem to be some variability from scene to scene, however, from the graph we can still see that <em>on average</em> the change of the frequencies seems to be centered around zero, even shifted sligtly toward the negative side meaning that it is more probable that the frequency of saccades <em>decreases</em> slightly as time progresses.</p>
</section>
<section id="blank-scenes" class="level3">
<h3 class="anchored" data-anchor-id="blank-scenes">Blank scenes</h3>
<p>We now repeat the exact same procedure, but for trials with <em>Blank</em> scene.</p>
<div class="cell" data-execution_count="25">
<details>
<summary>Sample the posterior distributions for all blank scenes</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>trials_blank <span class="op">=</span> df_hyp1_blank_sacc.trial.unique()</span>
<span id="cb24-2"><a href="#cb24-2"></a>trials_blank.sort()</span>
<span id="cb24-3"><a href="#cb24-3"></a>chains_blank <span class="op">=</span> []</span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="cf">for</span> trial <span class="kw">in</span> trials_blank:</span>
<span id="cb24-5"><a href="#cb24-5"></a>    trial_data <span class="op">=</span> df_hyp1_blank_sacc[df_hyp1_blank_sacc.trial <span class="op">==</span> trial]</span>
<span id="cb24-6"><a href="#cb24-6"></a>    model <span class="op">=</span> model_saccades(trial_data)</span>
<span id="cb24-7"><a href="#cb24-7"></a>    <span class="cf">with</span> model:</span>
<span id="cb24-8"><a href="#cb24-8"></a>        chain <span class="op">=</span> pm.sample(<span class="dv">5_000</span>)</span>
<span id="cb24-9"><a href="#cb24-9"></a>        chains_blank.append(chain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="26">
<details>
<summary>Combine Blank data from all chains</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a>combined_blank <span class="op">=</span> []</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="cf">for</span> trial, chain <span class="kw">in</span> <span class="bu">zip</span>(trials_blank, chains_blank):</span>
<span id="cb25-3"><a href="#cb25-3"></a>    df <span class="op">=</span> chain.posterior.to_dataframe()</span>
<span id="cb25-4"><a href="#cb25-4"></a>    df[<span class="st">"trial"</span>] <span class="op">=</span> trial</span>
<span id="cb25-5"><a href="#cb25-5"></a>    combined_blank.append(df)</span>
<span id="cb25-6"><a href="#cb25-6"></a>    </span>
<span id="cb25-7"><a href="#cb25-7"></a>combined_blank <span class="op">=</span> pd.concat(combined_blank)</span>
<span id="cb25-8"><a href="#cb25-8"></a>combined_blank <span class="op">=</span> combined_blank.assign(abs_delta<span class="op">=</span><span class="kw">lambda</span> _: np.<span class="bu">abs</span>(_[<span class="st">'delta'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="27">
<details>
<summary>Plot posterior density of <span class="math inline">\(\Delta\)</span> for all blank scenes.</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>statistic <span class="op">=</span> <span class="st">"delta"</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co"># Truncate values to 99% most plausible</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>low, up <span class="op">=</span> combined_blank.delta.quantile([<span class="fl">0.005</span>, <span class="fl">0.995</span>])</span>
<span id="cb26-4"><a href="#cb26-4"></a>hlp <span class="op">=</span> pd.DataFrame()</span>
<span id="cb26-5"><a href="#cb26-5"></a>hlp[statistic] <span class="op">=</span> combined_blank[statistic].where(combined_blank[statistic].between(low, up))</span>
<span id="cb26-6"><a href="#cb26-6"></a>hlp[<span class="st">"trial"</span>] <span class="op">=</span> combined_blank[<span class="st">"trial"</span>]</span>
<span id="cb26-7"><a href="#cb26-7"></a>hlp.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-8"><a href="#cb26-8"></a></span>
<span id="cb26-9"><a href="#cb26-9"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>hlp, x<span class="op">=</span><span class="st">"delta"</span>, hue<span class="op">=</span><span class="st">"trial"</span>, kind<span class="op">=</span><span class="st">"kde"</span>, aspect<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb26-10"><a href="#cb26-10"></a>g.ax.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'k'</span>, ls<span class="op">=</span><span class="st">'dashed'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-blank-delta-posterior" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="etra_challenge_files/figure-html/fig-blank-delta-posterior-output-1.png" width="1031" height="464" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6: Posterior density of <span class="math inline">\(\Delta\)</span> for all blank scenes of one chosen subject.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="28">
<details>
<summary>Compute probabilities of extreme cases</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>p_l2_lt_l1_094 <span class="op">=</span> (combined_blank[combined_blank.trial <span class="op">==</span> <span class="st">"094"</span>].delta <span class="op">&lt;</span> <span class="dv">0</span>).mean()</span>
<span id="cb27-2"><a href="#cb27-2"></a>p_l2_gt_l1_070 <span class="op">=</span> (combined_blank[combined_blank.trial <span class="op">==</span> <span class="st">"070"</span>].delta <span class="op">&gt;</span> <span class="dv">0</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The situation here is much more diverse in this case. We can see that we can find trials on both ends of the spectrum when considering the change in frequency of saccades. For example, for the trial <code>094</code> we have</p>
<div class="cell" data-execution_count="29">
<div class="cell-output cell-output-stdout">
<pre><code>Pr[ lambda_2 &lt; lambda_1 ] = 0.9917</code></pre>
</div>
</div>
<p>so there is a very high probability of a <em>decrease</em> in the frequency of saccades at some point in the trial. On the other hand, for trial <code>061</code> we have</p>
<div class="cell" data-execution_count="30">
<div class="cell-output cell-output-stdout">
<pre><code>Pr[ lambda_2 &gt; lambda_1 ] = 0.99975</code></pre>
</div>
</div>
<p>meaning a high ptobability of an <em>increase</em> in frequency.</p>
<p>This seems quite surprising as one might expect consistent behaviour when viewing the same blank scene multiple times.</p>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<div class="cell" data-execution_count="31">
<details>
<summary>Compute the probability of null hypothesis being true</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>p_l2_ge_l1_natural_combined <span class="op">=</span> (combined_natural.delta <span class="op">&gt;=</span> <span class="dv">0</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Considering all natural scenes as a whole, the probability that the frequency of saccades does not decrease is</p>
<div class="cell" data-execution_count="32">
<div class="cell-output cell-output-stdout">
<pre><code>Pr[ H_0 ] = Pr[ lambda_2 &gt;= lambda_1 ] = 0.393</code></pre>
</div>
</div>
<p>which is not low enough to reject the null hypothesis</p>
<div class="cell" data-execution_count="33">
<details>
<summary>Compute probability of null hypothesis for Blank trials</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>p_l2_ge_l1_blank_combined <span class="op">=</span> (combined_blank.delta <span class="op">&gt;=</span> <span class="dv">0</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Considering all the blank trials as a whole, the probability of increase in saccades is</p>
<div class="cell" data-execution_count="34">
<div class="cell-output cell-output-stdout">
<pre><code>Pr[ H_0 ] = Pr[ lambda_2 &gt;= lambda_1 ] = 0.421</code></pre>
</div>
</div>
<p>which is not low enough to reject the null hypothesis</p>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<p>In this section, we will examine certain assumptions that may have influenced the outcome of our model. One assumption made is that the distribution of saccades is independent of the selected time interval for examination. However, it is possible that the number of saccades may vary over time due to factors such as participant fatigue.</p>
<p>Additionally, we have assumed that there is a single point of change within the data. However, it is feasible that there may be multiple points of change or that the change may occur gradually. Further exploration of these possibilities may serve as a means for model improvement.</p>
<p>Furthermore, our model utilizes specific priors for the parameters. While we have chosen what we believe to be conservative priors, alternative options such as Half-Cauchy or Truncated Normal distributions for the <span class="math inline">\(\lambda\)</span>s should also be considered. Additionally, the selection of hyperparameters should be evaluated. We claim that the choice of hyperparameters did not have a significant impact on the model’s results and served primarily to improve the speed of convergence of the chain.</p>
<p>Lastly, we did not take into account the examination of trials as a cohesive unit. Each trial was analyzed individually, but it is possible that the order, type and difficulty of prior trials may have affected performance on subsequent trials.</p>
</section>
</section>
<section id="hypothesis-2-pupil-dilation" class="level1">
<h1>Hypothesis 2: Pupil dilation</h1>
<p>We will study the following hypotheses:</p>
<ul>
<li><span class="math inline">\(H_0^{(T)}\)</span> <em>(null hypothesis)</em> : The mean pupil size is equal when comparing Blank scene and a type T scene</li>
<li><span class="math inline">\(H_1^{(T)}\)</span> <em>(alternative hypothesis)</em> : The mean pupil size is <em>not</em> equal when comparing Blank scene and a type T scene</li>
</ul>
<section id="load-data-1" class="level2">
<h2 class="anchored" data-anchor-id="load-data-1">Load Data</h2>
<p>Again, we will limit our analysis to data collected from a single participant, specifically participant ID <code>022</code>. The participant was selected arbitrarily. We have selected and loaded all data collected during the “Free Viewing” task. Our focus will be on the following columns of the dataset:</p>
<ul>
<li><code>time</code>: representing the time in milliseconds elapsed from the beginning of the trial.</li>
<li><code>rp</code>: indicating the size of the right pupil.</li>
</ul>
<p>In <a href="#tbl-hyp2-data">Table&nbsp;4</a> we list a sample of data we work with.</p>
<div class="cell" data-execution_count="35">
<details>
<summary>Load data</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>df_hyp2 <span class="op">=</span> (dataset.data_dir <span class="op">/</span> <span class="st">"data"</span> <span class="op">/</span> <span class="st">"</span><span class="sc">{0:0&gt;3}</span><span class="st">"</span>.<span class="bu">format</span>(subject_no)).glob(<span class="st">"*FreeViewing_*.csv"</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a>df_hyp2 <span class="op">=</span> pd.concat((read_data(f) <span class="cf">for</span> f <span class="kw">in</span> df_hyp2)).sort_values(by<span class="op">=</span><span class="st">"Time"</span>)</span>
<span id="cb34-3"><a href="#cb34-3"></a></span>
<span id="cb34-4"><a href="#cb34-4"></a>df_hyp2 <span class="op">=</span> df_hyp2.rename({<span class="st">"Time"</span>: <span class="st">"time"</span>, <span class="st">"trial_id"</span>: <span class="st">"trial"</span>, <span class="st">"RP"</span>: <span class="st">"rp"</span>}, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb34-5"><a href="#cb34-5"></a>df_hyp2[<span class="st">"time"</span>] <span class="op">=</span> df_hyp2.groupby([<span class="st">"participant_id"</span>, <span class="st">"trial"</span>])[<span class="st">"time"</span>].transform(<span class="kw">lambda</span> x: x <span class="op">-</span> x.<span class="bu">min</span>())</span>
<span id="cb34-6"><a href="#cb34-6"></a></span>
<span id="cb34-7"><a href="#cb34-7"></a>df_hyp2 <span class="op">=</span> df_hyp2[[<span class="st">'participant_id'</span>, <span class="st">'trial'</span>, <span class="st">'fv_fixation'</span>, <span class="st">'task_type'</span>, <span class="st">'stimulus_id'</span>,</span>
<span id="cb34-8"><a href="#cb34-8"></a>       <span class="st">'time'</span>,<span class="st">'rp'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="36">
<details>
<summary>List a sample of data for hypothesis 2.</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a>df_hyp2.head() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="35">
<div id="tbl-hyp2-data" class="anchored">

<div>

<table class="dataframe table table-sm table-striped"><caption>Table&nbsp;4:  Sample of data for hypothesis 2 </caption>
  <thead>
    <tr>
      <th></th>
      <th>participant_id</th>
      <th>trial</th>
      <th>fv_fixation</th>
      <th>task_type</th>
      <th>stimulus_id</th>
      <th>time</th>
      <th>rp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>022</td>
      <td>001</td>
      <td>FreeViewing</td>
      <td>Puzzle</td>
      <td>puz008</td>
      <td>0</td>
      <td>585</td>
    </tr>
    <tr>
      <th>1</th>
      <td>022</td>
      <td>001</td>
      <td>FreeViewing</td>
      <td>Puzzle</td>
      <td>puz008</td>
      <td>2</td>
      <td>585</td>
    </tr>
    <tr>
      <th>2</th>
      <td>022</td>
      <td>001</td>
      <td>FreeViewing</td>
      <td>Puzzle</td>
      <td>puz008</td>
      <td>4</td>
      <td>585</td>
    </tr>
    <tr>
      <th>3</th>
      <td>022</td>
      <td>001</td>
      <td>FreeViewing</td>
      <td>Puzzle</td>
      <td>puz008</td>
      <td>6</td>
      <td>587</td>
    </tr>
    <tr>
      <th>4</th>
      <td>022</td>
      <td>001</td>
      <td>FreeViewing</td>
      <td>Puzzle</td>
      <td>puz008</td>
      <td>8</td>
      <td>585</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="data-manipulation-1" class="level2">
<h2 class="anchored" data-anchor-id="data-manipulation-1">Data Manipulation</h2>
<p>Again, we remove the blinks and then calculate the mean pupil size for each trial.</p>
<div class="cell" data-execution_count="37">
<details>
<summary>Remove blinks and calculate average pupil size.</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>df_hyp2_avg_rp <span class="op">=</span> df_hyp2.groupby(<span class="st">"trial"</span>)<span class="op">\</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>    .<span class="bu">apply</span>(remove_blinks)<span class="op">\</span></span>
<span id="cb36-3"><a href="#cb36-3"></a>    .reset_index(drop<span class="op">=</span><span class="va">True</span>)<span class="op">\</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>    .groupby([<span class="st">"trial"</span>, <span class="st">"task_type"</span>])<span class="op">\</span></span>
<span id="cb36-5"><a href="#cb36-5"></a>    .agg(avg_rp<span class="op">=</span>(<span class="st">'rp'</span>, <span class="st">'mean'</span>))<span class="op">\</span></span>
<span id="cb36-6"><a href="#cb36-6"></a>    .reset_index()<span class="op">\</span></span>
<span id="cb36-7"><a href="#cb36-7"></a>    .drop(<span class="st">"trial"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="38">
<details>
<summary>Report the average pupil size for each task type.</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>df_hyp2_avg_rp.head().<span class="bu">round</span>(decimals<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="37">
<div id="tbl-avg-rp" class="anchored">

<div>

<table class="dataframe table table-sm table-striped"><caption>Table&nbsp;5:  Average pupil size (right eye) for each task type. </caption>
  <thead>
    <tr>
      <th></th>
      <th>task_type</th>
      <th>avg_rp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Puzzle</td>
      <td>734.91</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Waldo</td>
      <td>664.90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Natural</td>
      <td>596.14</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Blank</td>
      <td>554.77</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Waldo</td>
      <td>657.94</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="exploration" class="level2">
<h2 class="anchored" data-anchor-id="exploration">Exploration</h2>
<p>Looking at <a href="#fig-avg-rp-dist-box">Figure&nbsp;7</a>, we can see that there except for the “Natural” scenes there are no significant outliers in any other category. <a href="#tbl-avg-rp-summary">Table&nbsp;6</a> lists summary statistics about the average pupil size.</p>
<div class="cell" data-execution_count="39">
<details>
<summary>Plot the distribution of the average pupil size.</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a>g <span class="op">=</span> sns.catplot(data<span class="op">=</span>df_hyp2_avg_rp, x<span class="op">=</span><span class="st">'task_type'</span>, y<span class="op">=</span><span class="st">'avg_rp'</span>, kind<span class="op">=</span><span class="st">'box'</span>, aspect<span class="op">=</span><span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>g.set_xlabels(<span class="st">"Task type"</span>)</span>
<span id="cb38-3"><a href="#cb38-3"></a>g.set_ylabels(<span class="st">"Average pupil size"</span>)</span>
<span id="cb38-4"><a href="#cb38-4"></a>g.<span class="bu">set</span>(title<span class="op">=</span><span class="st">"Average pupil size distribution."</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-avg-rp-dist-box" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="etra_challenge_files/figure-html/fig-avg-rp-dist-box-output-1.png" width="1424" height="483" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;7: Distribution of the average pupil size across different task types.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="40">
<details>
<summary>Compute summary statistics for average pupil sizes</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>df_hyp2_avg_rp.groupby(<span class="st">"task_type"</span>).describe().<span class="bu">round</span>(decimals<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="39">
<div id="tbl-avg-rp-summary" class="anchored">

<div>

<table class="dataframe table table-sm table-striped"><caption>Table&nbsp;6:  Summary statistics for average pupil sizes. </caption>
  <thead>
    <tr>
      <th></th>
      <th colspan="8" halign="left">avg_rp</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>task_type</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Blank</th>
      <td>15.0</td>
      <td>589.78</td>
      <td>89.22</td>
      <td>438.20</td>
      <td>537.63</td>
      <td>592.73</td>
      <td>650.43</td>
      <td>711.32</td>
    </tr>
    <tr>
      <th>Natural</th>
      <td>15.0</td>
      <td>635.84</td>
      <td>91.14</td>
      <td>464.97</td>
      <td>587.33</td>
      <td>636.75</td>
      <td>662.73</td>
      <td>797.62</td>
    </tr>
    <tr>
      <th>Puzzle</th>
      <td>15.0</td>
      <td>699.44</td>
      <td>89.15</td>
      <td>594.43</td>
      <td>631.53</td>
      <td>664.14</td>
      <td>748.29</td>
      <td>856.61</td>
    </tr>
    <tr>
      <th>Waldo</th>
      <td>15.0</td>
      <td>724.14</td>
      <td>112.28</td>
      <td>598.10</td>
      <td>627.82</td>
      <td>709.60</td>
      <td>801.23</td>
      <td>941.75</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
<p>Let us look at the distribution of the means. If we want to use t-test, we want our data to be roughly normally distributed.</p>
<div class="cell" data-execution_count="41">
<details>
<summary>Plot the distribution of average pupil sizes</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>df_hyp2_avg_rp, x<span class="op">=</span><span class="st">'avg_rp'</span>, hue<span class="op">=</span><span class="st">'task_type'</span>, col<span class="op">=</span><span class="st">"task_type"</span>)</span>
<span id="cb40-2"><a href="#cb40-2"></a>g.set_xlabels(<span class="st">"Average pupil size"</span>)</span>
<span id="cb40-3"><a href="#cb40-3"></a>g.set_ylabels(<span class="st">"Count"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-avg-rp-dist-bar" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="etra_challenge_files/figure-html/fig-avg-rp-dist-bar-output-1.png" width="2014" height="464" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;8: Distribution of average pupil sizes by task type.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Looking at the graphs in <a href="#fig-avg-rp-dist-bar">Figure&nbsp;8</a>, the distribution of the data seems to be roughly normal, however it is hard to gauge this from such a small sample size. We use the Shapiro-Wilk test, which tests the null hypothesis that the data was drawn from a normal distribution.</p>
<div class="cell" data-execution_count="42">
<details>
<summary>Compute Shapiro-Wilk test for distribution normality</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a><span class="bu">print</span>(<span class="st">"Resulting p-values from the Shapiro-Wilk test:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="cf">for</span> task_type <span class="kw">in</span> [<span class="st">"Blank"</span>, <span class="st">"Puzzle"</span>, <span class="st">"Waldo"</span>, <span class="st">"Natural"</span>]:</span>
<span id="cb41-3"><a href="#cb41-3"></a>    shapiro_result <span class="op">=</span> stats.shapiro(df_hyp2_avg_rp[df_hyp2_avg_rp.task_type <span class="op">==</span> task_type].avg_rp)</span>
<span id="cb41-4"><a href="#cb41-4"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\t</span><span class="sc">{}</span><span class="ch">\t</span><span class="st">: </span><span class="sc">{:0.3}</span><span class="st">"</span>.<span class="bu">format</span>(task_type, shapiro_result.pvalue))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Resulting p-values from the Shapiro-Wilk test:

    Blank   : 0.374
    Puzzle  : 0.0556
    Waldo   : 0.142
    Natural : 0.592</code></pre>
</div>
</div>
<p>Using signifance level of <span class="math inline">\(\alpha = 0.05\)</span>, we conclude that the data is distributed normally (although this is a bit debatable in the case of the “Puzzle” task).</p>
</section>
<section id="results-1" class="level2">
<h2 class="anchored" data-anchor-id="results-1">Results</h2>
<p>Given that we are evaluating the same participant across different tasks, it is appropriate to use the paired t-test as the data points are linked to one another. This statistical test allows for the comparison of each task with our chosen baseline, which is the blank scene.</p>
<div class="cell" data-execution_count="43">
<details>
<summary>Compute paired t-test for each category with the baseline.</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a>baseline <span class="op">=</span> <span class="st">"Blank"</span></span>
<span id="cb43-2"><a href="#cb43-2"></a></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="bu">print</span>(<span class="st">"Resulting p-values from the paired t-test:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="cf">for</span> task_type <span class="kw">in</span> [<span class="st">"Puzzle"</span>, <span class="st">"Waldo"</span>, <span class="st">"Natural"</span>]:</span>
<span id="cb43-5"><a href="#cb43-5"></a>    ttest_result <span class="op">=</span> stats.ttest_ind(</span>
<span id="cb43-6"><a href="#cb43-6"></a>        df_hyp2_avg_rp[df_hyp2_avg_rp.task_type <span class="op">==</span> baseline].avg_rp,</span>
<span id="cb43-7"><a href="#cb43-7"></a>        df_hyp2_avg_rp[df_hyp2_avg_rp.task_type <span class="op">==</span> task_type].avg_rp,</span>
<span id="cb43-8"><a href="#cb43-8"></a>    )</span>
<span id="cb43-9"><a href="#cb43-9"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\t</span><span class="sc">{}</span><span class="ch">\t</span><span class="st">: </span><span class="sc">{:0.3}</span><span class="st">"</span>.<span class="bu">format</span>(task_type, ttest_result.pvalue))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Resulting p-values from the paired t-test:

    Puzzle  : 0.00222
    Waldo   : 0.00113
    Natural : 0.173</code></pre>
</div>
</div>
<p>Thus using significance level of <span class="math inline">\(\alpha = 0.05\)</span>, we reject the null hypothesis for the <em>Puzzle</em> and <em>Waldo</em> tasks, meaning the mean pupil size differs from the baseline (greater as can be seen from <a href="#fig-avg-rp-dist-box">Figure&nbsp;7</a>). We were not able to reject the null hypothesis in case of the <em>Natural</em> task.</p>
</section>
<section id="discussion-1" class="level2">
<h2 class="anchored" data-anchor-id="discussion-1">Discussion</h2>
<p>Another interesting metric to consider might be the number of times the pupil size peaks and the count of such peaks.</p>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-BlinkDuration" class="csl-entry" role="doc-biblioentry">
<span>“Average Duration of a Single Eye Blink.”</span> n.d. <em>Average Duration of a Single Eye Blink - Human Homo Sapiens - BNID 100706</em>. <a href="https://bionumbers.hms.harvard.edu/bionumber.aspx?id=100706&amp;amp;ver=4&amp;amp;trm=blink%2B&amp;amp;org=">https://bionumbers.hms.harvard.edu/bionumber.aspx?id=100706&amp;amp;ver=4&amp;amp;trm=blink%2B&amp;amp;org=</a>.
</div>
<div id="ref-Dar2019" class="csl-entry" role="doc-biblioentry">
Dar, Asim H., Adina S. Wagner, and Michael Hanke. 2019. <span>“<span>REMoDNaV</span>: Robust Eye-Movement Classification for Dynamic Stimulation,”</span> April. <a href="https://doi.org/10.1101/619254">https://doi.org/10.1101/619254</a>.
</div>
<div id="ref-mitzenmacher_upfal_2012" class="csl-entry" role="doc-biblioentry">
Mitzenmacher, Michael, and Eli Upfal. 2012. <em>Probability and Computing Randomized Algorithms and Probabilistic Analysis</em>. Cambridge Univ. Press.
</div>
<div id="ref-PupilDiameter" class="csl-entry" role="doc-biblioentry">
<span>“Pupil Diameter.”</span> n.d. <em>Pupil Diameter - Human Homo Sapiens - BNID 105349</em>. <a href="https://bionumbers.hms.harvard.edu/bionumber.aspx?id=105349&amp;amp;ver=4&amp;amp;trm=pupil%2Bsize&amp;amp;org=">https://bionumbers.hms.harvard.edu/bionumber.aspx?id=105349&amp;amp;ver=4&amp;amp;trm=pupil%2Bsize&amp;amp;org=</a>.
</div>
<div id="ref-Salvatier2016" class="csl-entry" role="doc-biblioentry">
Salvatier, John, Thomas V. Wiecki, and Christopher Fonnesbeck. 2016. <span>“Probabilistic Programming in Python Using <span>PyMC</span>3.”</span> <em><span>PeerJ</span> Computer Science</em> 2 (April): e55. <a href="https://doi.org/10.7717/peerj-cs.55">https://doi.org/10.7717/peerj-cs.55</a>.
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>